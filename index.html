<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quebra-cabeÃ§a Educacional â€“ Humildoso</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f5f5f5;
  text-align:center;
  margin:0;
  padding:10px;
}
#controls{ margin:10px 0; }
select{ padding:8px; font-size:16px; }

#puzzle{
  margin:20px auto;
  display:grid;
  gap:4px;
  touch-action:manipulation;
}
.piece{
  border-radius:6px;
  background-repeat:no-repeat;
  cursor:pointer;
  touch-action:none;
}
.piece.active{
  outline:3px solid #38b2ac;
}
#message{
  display:none;
  font-size:22px;
  margin-top:20px;
  color:#2c7a7b;
  font-weight:bold;
  animation: pop 0.6s ease forwards;
}
@keyframes pop{
  from{ transform:scale(0.8); opacity:0; }
  to{ transform:scale(1); opacity:1; }
}
</style>
</head>

<body>

<h2>Monte o quebra-cabeÃ§a ðŸŽµ</h2>
<p>Toque em uma peÃ§a e depois em outra para trocar.</p>

<div id="controls">
  <label>Dificuldade: </label>
  <select id="level">
    <option value="12">FÃ¡cil (12 peÃ§as)</option>
    <option value="24">MÃ©dio (24 peÃ§as)</option>
    <option value="48" selected>DifÃ­cil (48 peÃ§as)</option>
  </select>
</div>

<div id="puzzle"></div>

<div id="message">
ðŸŽ‰ <strong>Esse Ã© o HUMILDOSO!</strong><br>
Aprender tambÃ©m pode ser divertido ðŸŽ¶
</div>

<script>
const puzzle = document.getElementById("puzzle");
const level = document.getElementById("level");
const message = document.getElementById("message");

let pieces = [];
let selectedIndex = null;
let cols, size, pieceSize;

function setup(total){
  puzzle.innerHTML = "";
  message.style.display = "none";

  cols = Math.round(Math.sqrt(total));
  size = Math.min(window.innerWidth - 40, 360);
  pieceSize = size / cols;

  puzzle.style.width = size + "px";
  puzzle.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

  pieces = Array.from({length: total}, (_,i)=>i)
    .sort(()=>Math.random()-0.5);

  for(let i=0;i<total;i++){
    const div = document.createElement("div");
    div.className = "piece";
    div.style.width = pieceSize + "px";
    div.style.height = pieceSize + "px";

    div.addEventListener("pointerdown", (e)=>{
      e.preventDefault();
      handleSelect(i);
    });

    puzzle.appendChild(div);
  }

  render();
}

function render(){
  document.querySelectorAll(".piece").forEach((div, index)=>{
    const imgIndex = pieces[index];
    const x = imgIndex % cols;
    const y = Math.floor(imgIndex / cols);

    div.style.backgroundImage = "url('Hmildoso.png')";
    div.style.backgroundSize = `${size}px ${size}px`;
    div.style.backgroundPosition = `-${x*pieceSize}px -${y*pieceSize}px`;
    div.classList.toggle("active", index === selectedIndex);
  });
}

function handleSelect(index){
  if(selectedIndex === null){
    selectedIndex = index;
  }else{
    [pieces[selectedIndex], pieces[index]] =
    [pieces[index], pieces[selectedIndex]];
    selectedIndex = null;
    render();
    checkWin();
  }
}

function checkWin(){
  if(pieces.every((v,i)=>v===i)){
    message.style.display = "block";
  }
}

level.addEventListener("change", ()=>setup(+level.value));
setup(48);
</script>

</body>
</html>
