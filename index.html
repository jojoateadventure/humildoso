
<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quebra-cabeÃ§a Educacional â€“ Humildoso</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f5f5f5;
  text-align:center;
  margin:0;
  padding:10px;
}
#controls{ margin:10px 0; }
select{ padding:8px; font-size:16px; }

#puzzle{
  position:relative;
  margin:20px auto;
  display:grid;
  gap:2px;
}
.piece{
  border-radius:6px;
  cursor:grab;
  touch-action:none;
  transition: transform 0.2s;
}
.piece.dragging{
  position:absolute;
  z-index:10;
  opacity:0.85;
  cursor:grabbing;
}
#message{
  display:none;
  font-size:22px;
  margin-top:20px;
  color:#2c7a7b;
  font-weight:bold;
  animation: pop 0.6s ease forwards;
}
@keyframes pop{
  from{ transform:scale(0.8); opacity:0; }
  to{ transform:scale(1); opacity:1; }
}
</style>
</head>

<body>

<h2>Monte o quebra-cabeÃ§a ðŸŽµ</h2>
<p>Arraste as peÃ§as para montar a imagem.</p>

<div id="controls">
  <label>Dificuldade: </label>
  <select id="level">
    <option value="12">FÃ¡cil (12 peÃ§as)</option>
    <option value="24">MÃ©dio (24 peÃ§as)</option>
    <option value="48" selected>DifÃ­cil (48 peÃ§as)</option>
  </select>
</div>

<div id="puzzle"></div>

<div id="message">
ðŸŽ‰ <strong>Esse Ã© o HUMILDOSO!</strong><br>
Aprender tambÃ©m pode ser divertido ðŸŽ¶
</div>

<script>
const puzzle = document.getElementById('puzzle');
const levelSelect = document.getElementById('level');
const message = document.getElementById('message');

let dragged = null;
let startX = 0, startY = 0;
let offsetX = 0, offsetY = 0;

function createPuzzle(total){
  puzzle.innerHTML = "";
  message.style.display = "none";

  const cols = Math.round(Math.sqrt(total));
  const rows = Math.ceil(total / cols);
  const size = Math.min(window.innerWidth - 40, 360);

  puzzle.style.width = size + "px";
  puzzle.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

  const pieceSize = size / cols;
  let pieces = [];

  for(let i=0;i<total;i++){
    const x = i % cols;
    const y = Math.floor(i / cols);

    const div = document.createElement('div');
    div.className = 'piece';
    div.style.width = pieceSize + "px";
    div.style.height = pieceSize + "px";
    div.style.backgroundImage = "url('Hmildoso.png')";
    div.style.backgroundSize = `${size}px ${size}px`;
    div.style.backgroundPosition = `-${x*pieceSize}px -${y*pieceSize}px`;
    div.dataset.correct = div.style.backgroundPosition;

    div.addEventListener('pointerdown', startDrag);
    pieces.push(div);
  }

  pieces.sort(()=>Math.random()-0.5).forEach(p=>puzzle.appendChild(p));
}

function startDrag(e){
  dragged = e.target;
  const rect = dragged.getBoundingClientRect();
  startX = rect.left;
  startY = rect.top;
  offsetX = e.clientX - rect.left;
  offsetY = e.clientY - rect.top;

  dragged.classList.add('dragging');
  dragged.setPointerCapture(e.pointerId);

  document.addEventListener('pointermove', moveDrag);
  document.addEventListener('pointerup', endDrag);
}

function moveDrag(e){
  if(!dragged) return;
  dragged.style.left = (e.clientX - offsetX) + "px";
  dragged.style.top = (e.clientY - offsetY) + "px";
}

function endDrag(e){
  let snapped = false;
  const threshold = 40;

  document.querySelectorAll('.piece').forEach(p=>{
    if(p !== dragged){
      const r1 = dragged.getBoundingClientRect();
      const r2 = p.getBoundingClientRect();
      const dx = r1.left - r2.left;
      const dy = r1.top - r2.top;
      const dist = Math.sqrt(dx*dx + dy*dy);

      if(dist < threshold){
        const temp = dragged.style.backgroundPosition;
        dragged.style.backgroundPosition = p.style.backgroundPosition;
        p.style.backgroundPosition = temp;
        snapped = true;
      }
    }
  });

  dragged.classList.remove('dragging');
  dragged.style.left = "";
  dragged.style.top = "";
  dragged.releasePointerCapture(e.pointerId);

  dragged = null;
  document.removeEventListener('pointermove', moveDrag);
  document.removeEventListener('pointerup', endDrag);

  if(snapped) checkWin();
}

function checkWin(){
  const pieces = document.querySelectorAll('.piece');
  let ok = true;
  pieces.forEach(p=>{
    if(p.style.backgroundPosition !== p.dataset.correct){
      ok = false;
    }
  });
  if(ok) message.style.display = "block";
}

levelSelect.addEventListener("change", ()=>createPuzzle(+levelSelect.value));
createPuzzle(48);
</script>

</body>
</html>
